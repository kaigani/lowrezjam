<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<title>LowRezJam: Zombie Sniper</title>

		<!-- mobile viewport: -->
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"/>
		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

		<!-- Libraries -->
		<script src="lib/dat.gui.min.js"></script>
		<script src="lib/sylvester.js"></script>
		<script src="lib/html5Preloader.js"></script>

		<!-- Core JS methods -->
		<script src="src/Utilities.js"></script> 
		<script src="src/Timer.js"></script>
		<script src="src/AudioHandler.js"></script>
		<script src="src/Stage.js"></script> 
		<script src="src/Animation.js"></script> 
		<script src="src/View.js"></script>

		<script src="src/GuiLayer.js"></script> 
		<script src="src/TextLayer.js"></script> 
		<script src="src/SpriteLayer.js"></script> 
		<script src="src/DamageLayer.js"></script> 

		<script src="src/Player.js"></script> 
		<script src="src/Enemy.js"></script> 
		<script src="src/Bullet.js"></script> 
		<script src="src/Obstacle.js"></script> 

		<!-- Game -->
		<script src="src/Game.js"></script> 

		<script>

			// GLOBALS

			var game;
			var preloader;

			//var canvas, c;

			// STAGE - for canvas drawing
			//var stage;

			// Game objects - move to Game.js
			//var player;
			//var view;

			// GUI & guiData 
			var gui;
			var guiData = {

				player : {
					get direction(){
						return game.player.direction;
					} ,
					set direction(value){
						game.player.setDirection(value);
					} ,
					get elevation(){
						return game.player.elevation;
					} ,
					set elevation(value){
						game.player.setElevation(value);
					}
				},

				region : {

					dx: 0,
					dy: 0,
					width: 0,
					height: 0,
					isVisible: true
				}
			};

			window.onload = function () {

				game = new Game();
				game.load();
				//game.start();
				
				//canvas = document.getElementById('myCanvas');
				//c = canvas.getContext('2d');
				
				// full-size canvas
				//canvas.width = document.body.clientWidth;
				//canvas.height = document.body.clientHeight;

				// Debugging gui
				/*
				gui = new dat.GUI();
				var f;
				gui.add(game,'FPS').listen(); // animation, frames per sec

				f = gui.addFolder('camera');
				f.add(game.view,'focalLength',0,10).step(0.1);
				f.add(game.view,'fov',0,360).step(1).listen();
				f.add(game.view,'height',0,2).step(0.1);
				f.add(game.view,'pixelScale',3000,5000).step(1);
				f.open();

				f = gui.addFolder('player');
				f.add(guiData.player,'direction',0,360).step(1).listen();
				f.add(guiData.player,'elevation',0,180).step(1).listen();
				//f.add(game.player.position,'x').step(1).listen();
				//f.add(game.player.position,'y').step(1).listen();
				f.open();

				f = gui.addFolder('enemy');
				f.add(game.enemy,'width').listen();
				f.add(game.enemy,'height').listen();
				f.add(game.enemy,'distance',0,360).step(1).listen();
				f.add(game.enemy,'direction',-360,360).step(1).listen();
				//f.add(game.enemy,'angle',-360,360).step(1).listen();
				f.open();

				f = gui.addFolder('region');
				f.add(guiData.region,'isVisible').listen();
				f.add(guiData.region,'dx').listen();
				f.add(guiData.region,'dy').listen();
				f.add(guiData.region,'width').listen();
				f.add(guiData.region,'height').listen();
				f.open();
				*/

				// Do preloading here
				preloader = game.loader;
				preloader.addFiles(

					"assets/img/background-02.png" ,
					"assets/img/ui_xl.png" ,
					"assets/img/ui_precision.png"
				);

				preloader.on('finish',function(){
					console.log('All assets loaded.');
					game.start();
				});


			} 
		</script>

		<script>
    		function BlockElasticScroll(event) {
        		event.preventDefault();
    		}
    	</script>
		
		<style type="text/css" media="screen">
			html {
				 height: 100%;
				 overflow: hidden;
			}
			
			body {
				margin:  0px;
				padding: 0px;
				height: 100%;
				background-color: black;
				color: white;
				font-family: sans-serif;
			}

			.example {
				margin-bottom: 20px;
			}

			.temp {
				padding: 20px;
			}
		</style>
		
	</head>
	<body ontouchmove="BlockElasticScroll(event);">
		<div class="temp">
			<p>[space] = shoot<br/></p>
			<p>arrow keys = aim<br/></p>
			<p>[shift] = zoom<br/></p>
		</div>
	</body>
</html>
		